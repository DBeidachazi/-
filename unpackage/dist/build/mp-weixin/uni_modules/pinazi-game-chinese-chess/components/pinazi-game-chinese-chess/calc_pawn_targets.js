"use strict";var s={all_matrix:[],getPointsArr(s,a){this.all_matrix=a;var i=[];switch(s.code){case"c":i=this.calcC(s,a);break;case"m":i=this.calcM(s,a);break;case"x":i=this.calcX(s,a);break;case"s":i=this.calcS(s,a);break;case"j":i=this.calcJ(s,a);break;case"p":i=this.calcP(s,a);break;case"z":i=this.calcZ(s,a)}return i},calcC(s,a){var i,r,t,n,h,l,v=[];t=n=i=s.x,h=l=r=s.y;for(var u=(i,r)=>!this.isPawnNotExistsOrIsRival(i,r,s)||(v.push(a[i][r]),!!a[i][r].status||void 0);t>=1&&!0!==u(r,--t););for(;n<=7&&!0!==u(r,++n););for(;h>=1&&!0!==u(--h,i););for(;l<=8&&!0!==u(++l,i););return v},calcM(s,a){var i,r,t=[];return i=s.x,r=s.y,i>=2&&(a[r][i-1].status||(this.isPawnNotExistsOrIsRival(r-1,i-2,s)&&t.push(a[r-1][i-2]),this.isPawnNotExistsOrIsRival(r+1,i-2,s)&&t.push(a[r+1][i-2]))),i<=6&&(a[r][i+1].status||(this.isPawnNotExistsOrIsRival(r-1,i+2,s)&&t.push(a[r-1][i+2]),this.isPawnNotExistsOrIsRival(r+1,i+2,s)&&t.push(a[r+1][i+2]))),r>=2&&(a[r-1][i].status||(this.isPawnNotExistsOrIsRival(r-2,i-1,s)&&t.push(a[r-2][i-1]),this.isPawnNotExistsOrIsRival(r-2,i+1,s)&&t.push(a[r-2][i+1]))),r<=7&&(a[r+1][i].status||(this.isPawnNotExistsOrIsRival(r+2,i-1,s)&&t.push(a[r+2][i-1]),this.isPawnNotExistsOrIsRival(r+2,i+1,s)&&t.push(a[r+2][i+1]))),t},calcX(s,a){var i,r,t=[];i=s.x;var n=[[[(r=s.y)-1,i-1],[r-2,i-2]],[[r+1,i-1],[r+2,i-2]],[[r-1,i+1],[r-2,i+2]],[[r+1,i+1],[r+2,i+2]]];for(var h in n){var l=n[h][0],v=n[h][1];this.isPawnEmpty(l[0],l[1])&&this.isPawnNotExistsOrIsRival(v[0],v[1],s)&&t.push(a[v[0]][v[1]])}return t=t.filter((a=>s.is_rival?a.y<=4:a.y>=5))},calcS(s,a){var i,r,t=[];i=s.x;var n,h,l=[[(r=s.y)-1,i-1],[r+1,i-1],[r+1,i+1],[r-1,i+1]];for(var v in l){var u=l[v][0],c=l[v][1];this.isPawnNotExistsOrIsRival(u,c,s)&&(n=u,h=c,s.is_rival?n<=2&&h>=3&&h<=5:n>=7&&h>=3&&h<=5)&&t.push(a[u][c])}return t},calcJ(s,a){var i,r,t=[];i=s.x,r=s.y;var n;a.forEach((a=>{a.forEach((a=>{if("j"===a.code&&a.is_rival!==s.is_rival)return n=a,!1}))}));var h,l,v=(s,i)=>{var r=!1;if(i===n.x){for(var t=Math.min(s,n.y),h=Math.max(s,n.y)-1,l=!1;h>t;){if(a[h][i].status){l=!0;break}h--}l||(r=!0)}return r},u=[[r-1,i],[r+1,i],[r,i+1],[r,i-1]];for(var c in u){var e=u[c][0],o=u[c][1];this.isPawnNotExistsOrIsRival(e,o,s)&&(h=e,l=o,s.is_rival?h<=2&&l>=3&&l<=5:h>=7&&l>=3&&l<=5)&&!v(e,o)&&t.push(a[e][o])}return t},calcP(s,a){var i,r,t,n,h,l,v=[],u={num:0};t=n=i=s.x,h=l=r=s.y;for(var c=(i,r)=>{if(!this.isPawnInPanel(i,r))return!0;if(u.num){if(!this.isPawnEmpty(i,r))return a[i][r].is_rival!==s.is_rival&&v.push(a[i][r]),!0}else this.isPawnEmpty(i,r)?v.push(a[i][r]):u.num++};t>=1&&!0!==c(r,--t););for(u.num=0;n<=7&&!0!==c(r,++n););for(u.num=0;h>=1&&!0!==c(--h,i););for(u.num=0;l<=8&&!0!==c(++l,i););return v},calcZ(s,a){var i,r,t=[];i=s.x,r=s.y;var n=[];for(var h in s.is_rival?(n.push([i,r+1]),s.y>4&&(n.push([i-1,r]),n.push([i+1,r]))):(n.push([i,r-1]),s.y<=4&&(n.push([i-1,r]),n.push([i+1,r]))),n){var l=n[h];this.isPawnNotExistsOrIsRival(l[1],l[0],s)&&t.push(a[l[1]][l[0]])}return t},isPawnInPanel:(s,a)=>!(s<0||s>9||a<0||a>8),isPawnEmpty(s,a){return!!this.isPawnInPanel(s,a)&&!this.all_matrix[s][a].status},isPawnNotExistsOrIsRival(s,a,i){return!!this.isPawnInPanel(s,a)&&(!this.all_matrix[s][a].status||this.all_matrix[s][a].is_rival!==i.is_rival)}};exports.calc_pawn_targets=s;
